<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <title>
    进程 &amp; 线程 |
    
    青稞
  </title>
  
    <link rel="shortcut icon" href="/favicon.ico">
    
  
<link rel="stylesheet" href="/css/style.css">

  
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="青稞" type="application/atom+xml">
</head>

<body>
  <main class="content">
    <section class="outer">
  <article id="post-进程-线程" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      

<h1 class="article-title" itemprop="name">
  进程 &amp; 线程
</h1>



    </header>
    

    
    <div class="article-meta">
      <a href="/2021/12/10/%E8%BF%9B%E7%A8%8B-%E7%BA%BF%E7%A8%8B/" class="article-date">
  <time datetime="2021-12-10T07:44:40.000Z" itemprop="datePublished">2021-12-10</time>
</a>
      
    </div>
    

    
    
<div class="tocbot"></div>

    

    <div class="article-entry" itemprop="articleBody">
      
      
      
      <h2 id="1-进程"><a href="#1-进程" class="headerlink" title="1. 进程"></a>1. 进程</h2><p>进程是程序的依次执行过程，或是正在运行的一个程序。是一个动态的过程：有它自身的产生、存在和消亡的过程——生命周期。</p>
<ul>
<li>程序由指令和数据组成，但这些指令要允许，数据要读写，就必须将指令加载至CPU，数据加载至内存。在指令允许过程中还需要用到磁盘、网络等设备。进程就是用来加载指令、管理内存、管理IO的。</li>
<li>当一个程序被允许，从磁盘加载这个程序的代码至内存，这时就开启了一个进程。</li>
<li>进程就可以视为程序的一个实例。大部分程序可以同时运行多个实例进程，也有的程序只能启动一个实例进程。</li>
<li><strong>进程作为资源分配的单位</strong>，系统在运行时会为每个进程分配不同的内存区域。</li>
</ul>
<h2 id="2-线程"><a href="#2-线程" class="headerlink" title="2. 线程"></a>2. 线程</h2><ul>
<li>一个进程内可以分为一到多个进程。</li>
<li>一个线程就是一个指令流，将指令流中的一条条指令以一定的顺序交给CPU执行。</li>
<li>若一个进程同一时间并行执行多个线程，就是支持多线程的。</li>
<li><strong>线程作为调度和执行的单位</strong>，每个线程拥有独立的运行栈和程序计数器，线程切换的开销小。</li>
<li>一个进程中的多个线程共享相同的内存单元/内存地址空间——它们从同一堆中分配对象，可以访问相同的变量和对象。这就使得线程间通信更简便、高效。但多个线程操作共享的系统资源可能就会带来安全的隐患。</li>
<li>在windows中进程是不活动的，只是作为线程的容器。</li>
</ul>
<h2 id="进程-amp-线程"><a href="#进程-amp-线程" class="headerlink" title="进程 &amp; 线程"></a>进程 &amp; 线程</h2><ul>
<li>线程基本上相互独立的，而线程存在于进程内，是进程的一个子集。</li>
<li>进程拥有共享的资源，如内存空间等，供其内部的线程共享。</li>
<li>进程间通信较为复杂：<ul>
<li>同一台计算机的进程通信称为IPC（Inter-precess communication）。</li>
<li>不同计算机之间的进程通信，需要通过网络，并遵守共同的协议，例如HTTP。</li>
</ul>
</li>
<li>线程通信相对简单，因为它们共享进程内的内存，一个例子是多个线程可以访问同一个共享变量。</li>
<li>线程更轻量，线程上下文切换成本一般要比进程上下文切换你低。</li>
</ul>
<h2 id="3-并行-amp-并发"><a href="#3-并行-amp-并发" class="headerlink" title="3. 并行 &amp; 并发"></a>3. 并行 &amp; 并发</h2><h3 id="3-1-单核CPU和多核CPU的理解"><a href="#3-1-单核CPU和多核CPU的理解" class="headerlink" title="3.1 单核CPU和多核CPU的理解"></a>3.1 单核CPU和多核CPU的理解</h3><ul>
<li>单核CPU：其实是一种假的多线程，因为在一个时间单元内，也只能执行一个线程的任务。例如：虽然有多车道，但是收费站只有一个工作人员在收费，只有收了费才能通过，那么CPU就好比收费人员。如果有某个人不想交钱，那么收费人员可以把他“挂起”（晾着他，等他想通了，准备好了钱，再去收费）。但是因为CPU时间单元特别短，因此感觉不出来。</li>
<li>如果是多核的话，才能更好的发挥出多线程的效率。</li>
<li>一个Java应用程序java.exe，其实至少有三个线程：main()主线程，gc()垃圾回收线程，异常处理线程。</li>
</ul>
<h3 id="3-2-并行"><a href="#3-2-并行" class="headerlink" title="3.2 并行"></a>3.2 并行</h3><p>所谓并行，就是指多个CPU同时执行多个任务。单核CPU下，线程实际上还是<strong>串行执行</strong>的。操作系统中有个组件叫做任务调度器，将CPU的时间片分给不同的程序使用，只是由于CPU在线程之间的切换非常快，人类感觉是<strong>同步运行</strong>的。总结为一句话就是：<strong>微观串行，宏观并行</strong>。</p>
<h3 id="3-3-并发"><a href="#3-3-并发" class="headerlink" title="3.3 并发"></a>3.3 并发</h3><p>并发就是一个CPU（采用时间片）同时执行多个任务。比如：秒杀、多个人做同一件事。</p>
<p>并发是同一时间应对多件事情的能力，而并行是同一时间动手做多件事情的能力。</p>
<h2 id="4-应用"><a href="#4-应用" class="headerlink" title="4. 应用"></a>4. 应用</h2><h3 id="4-1-异步调用"><a href="#4-1-异步调用" class="headerlink" title="4.1 异步调用"></a>4.1 异步调用</h3><p>以调用方角度来讲，如果：</p>
<ul>
<li>需要等待结果返回，才能继续运行就是同步</li>
<li>不需要等待结果返回，就能继续运行就是异步</li>
</ul>
<p>多线程可以让方法执行变为异步的，比如说读取磁盘文件时，假设读取操作花费了5秒钟，如果没有线程调度机制的话，在这5秒内CPU被占用，不能处理其它事情，导致其它代码都得暂停。</p>
<p>Tomcat的异步servlet，它让用户线程处理耗时较长的操作，避免阻塞Tomcat的工作线程。</p>
<h3 id="5-2-提高效率"><a href="#5-2-提高效率" class="headerlink" title="5.2 提高效率"></a>5.2 提高效率</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">gantt</span><br><span class="line">        dateFormat  </span><br><span class="line">        title 单道运行时三道程序时间关系图</span><br><span class="line">        section A</span><br><span class="line">        计算                      :2021-09-16,20d</span><br><span class="line">        I/O操作					: 30d</span><br><span class="line">        计算						: 10d</span><br><span class="line">    	section B</span><br><span class="line">    	</span><br><span class="line">        计算                      : 30d</span><br><span class="line">        I/O操作					: 50d</span><br><span class="line">        计算						: 20d</span><br><span class="line">    	section C</span><br><span class="line">        计算                      : 10d</span><br><span class="line">        I/O操作					: 20d</span><br><span class="line">        计算						: 10d</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">gantt</span><br><span class="line">        dateFormat  </span><br><span class="line">        title 多道运行时三道程序时间关系图</span><br><span class="line">        section A</span><br><span class="line">        I/O操作					: 2021-09-16,30d</span><br><span class="line">        计算                      : 20d</span><br><span class="line">        计算						: 10d</span><br><span class="line">    	section B	</span><br><span class="line">        计算                      : 2021-09-16,30d</span><br><span class="line">        I/O操作					: 50d</span><br><span class="line">        计算						: 20d</span><br><span class="line">    	section C</span><br><span class="line">        计算						: 2021-11-15,10d</span><br><span class="line">        计算                      : 10d</span><br><span class="line">        I/O操作					: 20d</span><br></pre></td></tr></table></figure>

<p>单核CPU下，多线程不能实际提高程序运行效率，只是为了能够在不同的任务之间切换，不同线程轮流使用CPU，不至于一个线程总是占用CPU，别的线程没法干活。</p>
<p>而在多核CPU中可以并行跑多个线程，但能否提高程序运行效率还是要分情况的：</p>
<ul>
<li>有些任务，经过精心设计，将任务拆分，并行执行，当然可以提高程序的运行效率。但不是所有计算任务都能拆分。</li>
<li>也不是所有任务都需要拆分，任务的目的如果不同，谈拆分和效率没啥意义。</li>
</ul>
<p>IO操作不占用CPU，只是我们一般拷贝文件使用的阻塞IO，这是相当于线程虽然不用CPU，但需要一直等待IO结束，没能充分利用线程。所有才有后面的非阻塞IO和异步IO优化。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/10/%E8%BF%9B%E7%A8%8B-%E7%BA%BF%E7%A8%8B/" data-id="ckx2yjv9k0009pgtw30a34e3f" class="article-share-link">
        Share
      </a>
      
    </footer>

  </div>

  
  
<nav class="article-nav">
  
  <a href="/2021/12/11/Java%E7%BA%BF%E7%A8%8B/" class="article-nav-link">
    <strong class="article-nav-caption">Newer</strong>
    <div class="article-nav-title">
      
      Java线程
      
    </div>
  </a>
  
  
  <a href="/2021/12/10/%E4%B9%90%E8%A7%82%E9%94%81-%E6%82%B2%E8%A7%82%E9%94%81/" class="article-nav-link">
    <strong class="article-nav-caption">Older</strong>
    <div class="article-nav-title">乐观锁 &amp; 悲观锁</div>
  </a>
  
</nav>

  

  
  
  
  

</article>
</section>
    <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
  <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
  <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>青稞 &copy; 2022</li>
      
        <li>ZHWANGART</li>
      
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>theme  <a target="_blank" rel="noopener" href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>
  </main>
  <aside class="sidebar">
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/hexo.svg" alt="青稞"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">Home</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">Archives</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/gallery">Gallery</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">About</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="fe fe-feed"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/copybtn.js"></script>





<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  });
</script>



<script src="/js/ocean.js"></script>

</body>

</html>